{% extends "layouts/docente_layout.html" %}

{% block docente_title %}Artículos{% endblock %}

{% block page_title %}Artículos Científicos{% endblock %}

{% block docente_content %}
<div class="articulos-wrapper">
    <!-- Header con botón de nuevo artículo -->
    <div class="section-header d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center gap-3 mb-4">
        <div>
            <h5 class="mb-1">
                <i class="bi bi-file-text me-2"></i>Mis Artículos
            </h5>
            <p class="text-muted mb-0 small">Gestiona tus publicaciones científicas</p>
        </div>
        <a href="{{ url_for('docente.nuevo_articulo') }}" class="btn btn-primary">
            <i class="bi bi-plus-lg me-1"></i>
            <span>Nuevo Artículo</span>
        </a>
    </div>
    
    {% if articulos %}
    <!-- Vista de tabla para pantallas grandes -->
    <div class="card shadow-sm d-none d-md-block">
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead class="table-light">
                    <tr>
                        <th>Título</th>
                        <th>Revista</th>
                        <th class="text-center">Año</th>
                        <th>DOI</th>
                        <th class="text-center">Destacado</th>
                        <th class="text-end">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for articulo in articulos %}
                    <tr>
                        <td>
                            <div class="text-truncate" style="max-width: 250px;" title="{{ articulo.titulo }}">
                                {{ articulo.titulo }}
                            </div>
                        </td>
                        <td>{{ articulo.revista or '-' }}</td>
                        <td class="text-center">{{ articulo.anio or '-' }}</td>
                        <td>
                            {% if articulo.doi %}
                            <a href="https://doi.org/{{ articulo.doi }}" target="_blank" class="text-decoration-none small">
                                {{ articulo.doi[:20] }}{% if articulo.doi|length > 20 %}...{% endif %}
                            </a>
                            {% else %}
                            -
                            {% endif %}
                        </td>
                        <td class="text-center">
                            {% if articulo.producto_destacado %}
                            <span class="badge bg-success">Sí</span>
                            {% else %}
                            <span class="badge bg-secondary">No</span>
                            {% endif %}
                        </td>
                        <td class="text-end">
                            <div class="btn-group btn-group-sm">
                                <a href="{{ url_for('docente.editar_articulo', id=articulo.id) }}" class="btn btn-outline-warning" title="Editar">
                                    <i class="bi bi-pencil"></i>
                                </a>
                                <form method="POST" action="{{ url_for('docente.eliminar_articulo', id=articulo.id) }}" style="display:inline;">
                                    <button type="submit" class="btn btn-outline-danger" onclick="return confirm('¿Estás seguro de eliminar este artículo?')" title="Eliminar">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </form>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Vista de tarjetas para móviles -->
    <div class="d-md-none">
        {% for articulo in articulos %}
        <div class="card shadow-sm mb-3 articulo-card">
            <div class="card-body">
                <h6 class="card-title mb-2">{{ articulo.titulo }}</h6>
                <div class="card-text small text-muted mb-2">
                    {% if articulo.revista %}
                    <div><i class="bi bi-journal me-1"></i>{{ articulo.revista }}</div>
                    {% endif %}
                    {% if articulo.anio %}
                    <div><i class="bi bi-calendar me-1"></i>{{ articulo.anio }}</div>
                    {% endif %}
                    {% if articulo.doi %}
                    <div>
                        <i class="bi bi-link-45deg me-1"></i>
                        <a href="https://doi.org/{{ articulo.doi }}" target="_blank" class="text-decoration-none">
                            DOI
                        </a>
                    </div>
                    {% endif %}
                </div>
                {% if articulo.producto_destacado %}
                <span class="badge bg-success mb-2">Destacado</span>
                {% endif %}
                <div class="d-flex gap-2 mt-2">
                    <a href="{{ url_for('docente.editar_articulo', id=articulo.id) }}" class="btn btn-sm btn-outline-warning flex-grow-1">
                        <i class="bi bi-pencil me-1"></i>Editar
                    </a>
                    <form method="POST" action="{{ url_for('docente.eliminar_articulo', id=articulo.id) }}" class="flex-grow-1">
                        <button type="submit" class="btn btn-sm btn-outline-danger w-100" onclick="return confirm('¿Estás seguro de eliminar este artículo?')">
                            <i class="bi bi-trash me-1"></i>Eliminar
                        </button>
                    </form>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    
    {% else %}
    <!-- Estado vacío -->
    <div class="card shadow-sm">
        <div class="card-body text-center py-5">
            <div class="empty-state">
                <i class="bi bi-file-text display-1 text-muted mb-3"></i>
                <h5>No hay artículos registrados</h5>
                <p class="text-muted mb-4">Comienza agregando tu primera publicación científica</p>
                <a href="{{ url_for('docente.nuevo_articulo') }}" class="btn btn-primary">
                    <i class="bi bi-plus-lg me-1"></i>Agregar Artículo
                </a>
            </div>
        </div>
    </div>
    {% endif %}
</div>

<style>
.articulos-wrapper .card {
    border: none;
    border-radius: 12px;
}

.articulos-wrapper .table {
    margin-bottom: 0;
}

.articulos-wrapper .table th {
    border-top: none;
    font-weight: 600;
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: #6c757d;
}

.articulos-wrapper .table td {
    vertical-align: middle;
    padding: 1rem 0.75rem;
}

.articulo-card {
    border-radius: 12px;
}

.articulo-card .card-title {
    font-weight: 600;
    line-height: 1.4;
}

.empty-state i {
    opacity: 0.3;
}

@media (max-width: 576px) {
    .section-header .btn {
        width: 100%;
    }
}
</style>
{% endblock %}
